{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabayApi.js","../src/js/index.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function searchImages(searchQuery, page) {\n  const API_KEY = `40817348-8cf9cc617061525653a12724b`;\n  const URL = `https://pixabay.com/api/`;\n  const per_page = 40;\n\n  try {\n    const response = await axios.get(URL, {\n      params: {\n        key: API_KEY,\n        q: searchQuery,\n        image_type: `photo`,\n        orientation: `horizontal`,\n        safesearch: true,\n        order: `popular`,\n        page: page,\n        per_page: per_page,\n      },\n    });\n\n    return response.data.hits;\n  } catch (error) {\n    throw error;\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport iziToast from 'izitoast';\nimport { searchImages } from './pixabayApi';\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  const form = document.getElementById('search-form');\n  const gallery = document.querySelector('.gallery');\n  const lightbox = new SimpleLightbox('.gallery a');\n  let currentPage = 1;\n  let searchQuery = '';\n  let observer;\n\n  form.addEventListener('submit', async function (event) {\n    event.preventDefault();\n    searchQuery = this.elements.searchQuery.value.trim();\n\n    if (!searchQuery) {\n      showErrorMessage('Please enter a search query');\n      return;\n    }\n    gallery.addEventListener('click', function (event) {\n      if (event.target.classList.contains('js-card-link')) {\n        event.preventDefault();\n        lightbox.open();\n      }\n    });\n\n    gallery.innerHTML = '';\n    observer = new IntersectionObserver(handleIntersection, { threshold: 0.2 });\n\n    try {\n      const images = await searchImages(searchQuery, currentPage);\n\n      if (images.length === 0) {\n        showInfoMessage(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n      } else {\n        renderImages(images, gallery);\n        lightbox.refresh();\n        observer.observe(gallery);\n      }\n    } catch (error) {\n      console.error('Error fetching images:', error);\n      showErrorMessage(\n        'An error occurred while fetching images. Please try again later.'\n      );\n    }\n  });\n\n  function handleIntersection(entries) {\n    if (entries[0].isIntersecting) {\n      loadMoreImages();\n    }\n  }\n\n  async function loadMoreImages() {\n    currentPage += 1;\n    observer.disconnect();\n\n    try {\n      const images = await searchImages(searchQuery, currentPage);\n\n      if (images.length > 0) {\n        renderImages(images, gallery);\n        lightbox.refresh();\n        observer.observe(gallery);\n      }\n    } catch (error) {\n      console.error('Error fetching more images:', error);\n      showErrorMessage(\n        'An error occurred while fetching more images. Please try again later.'\n      );\n    }\n  }\n\n  function renderImages(images, container) {\n    const markup = createMarkup({ hits: images });\n    container.innerHTML += markup;\n  }\n\n  function createMarkup(results) {\n    const { hits } = results;\n    return hits\n      .map(\n        hit => `\n        <a href=\"${hit.largeImageURL}\" class=\"card-link js-card-link\">\n          <div class=\"photo-card\">\n            <img src=\"${hit.webformatURL}\" alt=\"${hit.tags}\" loading=\"lazy\" class=\"photo\"/>\n            <div class=\"info\">\n              <p class=\"info-item\"><b>Likes:</b>${hit.likes}</p>\n              <p class=\"info-item\"><b>Views:</b>${hit.views}</p>\n              <p class=\"info-item\"><b>Comments:</b>${hit.comments}</p>\n              <p class=\"info-item\"><b>Downloads:</b>${hit.downloads}</p>\n            </div>\n          </div>\n        </a>\n      `\n      )\n      .join('');\n  }\n\n  function showErrorMessage(message) {\n    iziToast.error({\n      title: 'Error',\n      message: message,\n    });\n  }\n\n  function showInfoMessage(message) {\n    iziToast.info({\n      title: 'Info',\n      message: message,\n    });\n  }\n});\n"],"names":["searchImages","searchQuery","page","API_KEY","URL","axios","error","form","gallery","lightbox","SimpleLightbox","currentPage","observer","event","showErrorMessage","handleIntersection","images","showInfoMessage","renderImages","entries","loadMoreImages","container","markup","createMarkup","results","hits","hit","message","iziToast"],"mappings":"owBAEO,eAAeA,EAAaC,EAAaC,EAAM,CACpD,MAAMC,EAAU,qCACVC,EAAM,2BAGZ,GAAI,CAcF,OAbiB,MAAMC,EAAM,IAAID,EAAK,CACpC,OAAQ,CACN,IAAKD,EACL,EAAGF,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,MAAO,UACP,KAAMC,EACN,SAAU,EACX,CACP,CAAK,GAEe,KAAK,IACtB,OAAQI,EAAP,CACA,MAAMA,CACP,CACH,CCnBA,SAAS,iBAAiB,mBAAoB,UAAY,CACxD,MAAMC,EAAO,SAAS,eAAe,aAAa,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAW,IAAIC,EAAe,YAAY,EAChD,IAAIC,EAAc,EACdV,EAAc,GACdW,EAEJL,EAAK,iBAAiB,SAAU,eAAgBM,EAAO,CAIrD,GAHAA,EAAM,eAAc,EACpBZ,EAAc,KAAK,SAAS,YAAY,MAAM,KAAI,EAE9C,CAACA,EAAa,CAChBa,EAAiB,6BAA6B,EAC9C,MACD,CACDN,EAAQ,iBAAiB,QAAS,SAAUK,EAAO,CAC7CA,EAAM,OAAO,UAAU,SAAS,cAAc,IAChDA,EAAM,eAAc,EACpBJ,EAAS,KAAI,EAErB,CAAK,EAEDD,EAAQ,UAAY,GACpBI,EAAW,IAAI,qBAAqBG,EAAoB,CAAE,UAAW,EAAG,CAAE,EAE1E,GAAI,CACF,MAAMC,EAAS,MAAMhB,EAAaC,EAAaU,CAAW,EAEtDK,EAAO,SAAW,EACpBC,EACE,0EACV,GAEQC,EAAaF,EAAQR,CAAO,EAC5BC,EAAS,QAAO,EAChBG,EAAS,QAAQJ,CAAO,EAE3B,OAAQF,EAAP,CACA,QAAQ,MAAM,yBAA0BA,CAAK,EAC7CQ,EACE,kEACR,CACK,CACL,CAAG,EAED,SAASC,EAAmBI,EAAS,CAC/BA,EAAQ,GAAG,gBACbC,GAEH,CAED,eAAeA,GAAiB,CAC9BT,GAAe,EACfC,EAAS,WAAU,EAEnB,GAAI,CACF,MAAMI,EAAS,MAAMhB,EAAaC,EAAaU,CAAW,EAEtDK,EAAO,OAAS,IAClBE,EAAaF,EAAQR,CAAO,EAC5BC,EAAS,QAAO,EAChBG,EAAS,QAAQJ,CAAO,EAE3B,OAAQF,EAAP,CACA,QAAQ,MAAM,8BAA+BA,CAAK,EAClDQ,EACE,uEACR,CACK,CACF,CAED,SAASI,EAAaF,EAAQK,EAAW,CACvC,MAAMC,EAASC,EAAa,CAAE,KAAMP,CAAQ,CAAA,EAC5CK,EAAU,WAAaC,CACxB,CAED,SAASC,EAAaC,EAAS,CAC7B,KAAM,CAAE,KAAAC,CAAM,EAAGD,EACjB,OAAOC,EACJ,IACCC,GAAO;AAAA,mBACIA,EAAI;AAAA;AAAA,wBAECA,EAAI,sBAAsBA,EAAI;AAAA;AAAA,kDAEJA,EAAI;AAAA,kDACJA,EAAI;AAAA,qDACDA,EAAI;AAAA,sDACHA,EAAI;AAAA;AAAA;AAAA;AAAA,OAKnD,EACA,KAAK,EAAE,CACX,CAED,SAASZ,EAAiBa,EAAS,CACjCC,EAAS,MAAM,CACb,MAAO,QACP,QAASD,CACf,CAAK,CACF,CAED,SAASV,EAAgBU,EAAS,CAChCC,EAAS,KAAK,CACZ,MAAO,OACP,QAASD,CACf,CAAK,CACF,CACH,CAAC"}